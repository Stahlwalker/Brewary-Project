<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">
    <title>Testing API's</title>
  
</head>

<body>
	<div class="container">
		<div class="row">
			<div class="col-md-8 col-md-offset-2">
				<form>
					<input type="text" name="beerSearch" id="beerSearch">
					<input type="submit" name="submit" id="submit">
				</form>	
			</div>
		</div>
	</div>

	<div class="container">
		<div class="row">
			<table class="table" id="beer-table">
				<thead>
					<tr>
						<th>Beer Name</th>
						<th>Brewery Name</th>
						<th>ABV</th>
						<th>Style</th>
						<th>Glass style</th>
						
					</tr>
				</thead>

				<tbody id="beer-body"></tbody>
			</table>
		</div>
	</div>					


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript">

	jQuery.ajaxPrefilter(function(options) {
        if (options.crossDomain && jQuery.support.cors) {
            options.url = 'https://cors-anywhere.herokuapp.com/' + options.url;
        }
    });


	$("#submit").on("click", function(){
		event.preventDefault();
		$("#beer-body").empty();
		var beer = $("#beerSearch").val().trim();

        var queryURL =  "https://api.brewerydb.com/v2/search?q=" + beer + 
        "&withBreweries=Y&type=beer&key=3be3e987ffecfe82a589838b384c138f&format=json";

        $.ajax({
            url: queryURL,
            method: "GET"
          }).done(function(response) {
            console.log(response);
            var beers = response.data;

            console.log(beers[0].breweries[0].name);

            for(var i = 0; i < beers.length; i++){
            	//console.log(!beers[i].glass.name.equals("undefined"));
            	if(beers[i].hasOwnProperty('glass')){
	            	$("#beer-table > tbody").append("<tr><td>" + beers[i].name + "</td><td>" + beers[i].breweries[0].name + "</td><td>" 
	            		+ beers[i].abv + "%</td><td>" + beers[i].style.name + 
	            		 "</td><td>" + beers[i].glass.name + "</td></tr>");
            	}
            }

        });
    });     
 
            

</script>	
</body>	
